- name: dotfiles
  tags: dotfiles
  block:
    - name: Install Stow
      community.general.homebrew:
        name: stow

    - name: Clone .dotfiles
      ansible.builtin.git:
        repo: "https://github.com/karolis-sh/.dotfiles.git"
        dest: "{{ lookup('env', 'HOME') }}/.dotfiles"
        recursive: yes
        update: yes
        accept_hostkey: yes
        version: main

    - name: Stow dotfiles
      shell: cd $HOME/.dotfiles && ./setup.sh
